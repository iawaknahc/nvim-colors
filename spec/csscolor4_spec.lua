local csscolor4 = require("nvim-colors.csscolor4")

describe("angle", function()
  it("convert from deg to deg", function()
    assert.are_same({ 90, "deg" }, csscolor4.to_deg({ 100, "grad" }))
  end)
  it("convert from rad to deg", function()
    assert.are_same({ 90, "deg" }, csscolor4.to_deg({ 2 * math.pi / 4, "rad" }))
  end)
  it("convert from turn to deg", function()
    assert.are_same({ 90, "deg" }, csscolor4.to_deg({ 0.25, "turn" }))
  end)
end)

describe("percentage", function()
  it("convert to number", function()
    assert.are_same(1, csscolor4.percentage2number({ 100, "percentage" }))
    assert.are_same(0, csscolor4.percentage2number({ 0, "percentage" }))
    assert.are_same(-0.1, csscolor4.percentage2number({ -10, "percentage" }))

    assert.are_same(255, csscolor4.percentage2number({ 100, "percentage" }, 255))
    assert.are_same(0, csscolor4.percentage2number({ 0, "percentage" }, 255))
    assert.are_same(-25.5, csscolor4.percentage2number({ -10, "percentage" }, 255))
  end)
end)

describe("parse_value", function()
  it("parse none", function()
    assert.are_same("none", csscolor4.parse_value("none"))
    assert.are_same("none", csscolor4.parse_value("None"))
    assert.are_same("none", csscolor4.parse_value("NONE"))
    assert.are_same("none", csscolor4.parse_value("nONE"))
  end)
  it("parse number", function()
    assert.are_same(0, csscolor4.parse_value("0"))
    assert.are_same(1, csscolor4.parse_value("1"))
    assert.are_same(1, csscolor4.parse_value("+1"))
    assert.are_same(-1, csscolor4.parse_value("-1"))
    assert.are_same(1.1, csscolor4.parse_value("1.1"))
    assert.are_same(0.1, csscolor4.parse_value(".1"))
    assert.are_same(0.123, csscolor4.parse_value(".123"))
    assert.are_same(1000000, csscolor4.parse_value("1e6"))
    assert.are_same(-1000, csscolor4.parse_value("-1e3"))
  end)
  it("parse percentage", function()
    assert.are_same({ 0, "percentage" }, csscolor4.parse_value("0%"))
    assert.are_same({ 1, "percentage" }, csscolor4.parse_value("1%"))
    assert.are_same({ 1, "percentage" }, csscolor4.parse_value("+1%"))
    assert.are_same({ -1, "percentage" }, csscolor4.parse_value("-1%"))
    assert.are_same({ 1.1, "percentage" }, csscolor4.parse_value("1.1%"))
    assert.are_same({ 0.1, "percentage" }, csscolor4.parse_value(".1%"))
    assert.are_same({ 0.123, "percentage" }, csscolor4.parse_value(".123%"))
    assert.are_same({ 1000000, "percentage" }, csscolor4.parse_value("1e6%"))
    assert.are_same({ -1000, "percentage" }, csscolor4.parse_value("-1e3%"))
  end)
  it("parse angle", function()
    assert.are_same({ 0, "deg" }, csscolor4.parse_value("0deg"))
    assert.are_same({ 0, "grad" }, csscolor4.parse_value("0grad"))
    assert.are_same({ 0, "rad" }, csscolor4.parse_value("0rad"))
    assert.are_same({ 0, "turn" }, csscolor4.parse_value("0turn"))
  end)
  it("return nil for everything else", function()
    assert.are_same(nil, csscolor4.parse_value(""))
    assert.are_same(nil, csscolor4.parse_value("foobar"))
    assert.are_same(nil, csscolor4.parse_value("0X20"))
    assert.are_same(nil, csscolor4.parse_value("0x20"))
  end)
end)

describe("rgb", function()
  it("parse rgb", function()
    assert.are_same(nil, csscolor4.rgb("", "", ""))

    assert.are_same({ "rgb", { "none", "none", "none" } }, csscolor4.rgb("none", "none", "none"))
    assert.are_same({ "rgb", { "none", "none", "none" }, "none" }, csscolor4.rgb("none", "none", "none", "none"))

    assert.are_same({ "rgb", { "none", "none", "none" } }, csscolor4.rgb("NONE", "NONE", "NONE"))
    assert.are_same({ "rgb", { "none", "none", "none" }, "none" }, csscolor4.rgb("NONE", "NONE", "NONE", "NONE"))

    assert.are_same({ "rgb", { 0, 0, 0 } }, csscolor4.rgb("0", "0", "0"))
    assert.are_same({ "rgb", { 255, 255, 255 } }, csscolor4.rgb("255", "255", "255"))
    assert.are_same({ "rgb", { 51, 102, 153 } }, csscolor4.rgb("51", "102", "153"))
    assert.are_same({ "rgb", { 51, 102, 153 }, 0.5 }, csscolor4.rgb("51", "102", "153", "50%"))
    assert.are_same({ "rgb", { 51, 102, 153 }, 0.5 }, csscolor4.rgb("51", "102", "153", "0.5"))
    assert.are_same({ "rgb", { 255, 255, 255 }, 1 }, csscolor4.rgb("300", "300", "300", "120%"))
    assert.are_same({ "rgb", { 0, 0, 0 } }, csscolor4.rgb("-51", "-102", "-153"))
    assert.are_same({ "rgb", { 0, 0, 0 }, 0 }, csscolor4.rgb("-51", "-102", "-153", "-10%"))
    assert.are_same({ "rgb", { 0, 0, 0 }, 0 }, csscolor4.rgb("-51", "-102", "-153", "-0.1"))

    assert.are_same({ "rgb", { 0, 0, 0 } }, csscolor4.rgb("0%", "0%", "0%"))
    assert.are_same({ "rgb", { 255, 255, 255 } }, csscolor4.rgb("100%", "100%", "100%"))
    assert.are_same({ "rgb", { 51, 102, 153 } }, csscolor4.rgb("20%", "40%", "60%"))
    assert.are_same({ "rgb", { 51, 102, 153 }, 0.5 }, csscolor4.rgb("20%", "40%", "60%", "50%"))
    assert.are_same({ "rgb", { 51, 102, 153 }, 0.5 }, csscolor4.rgb("20%", "40%", "60%", "0.5"))
    assert.are_same({ "rgb", { 255, 255, 255 }, 1 }, csscolor4.rgb("120%", "120%", "120%", "120%"))
    assert.are_same({ "rgb", { 0, 0, 0 } }, csscolor4.rgb("-20%", "-40%", "-60%"))
    assert.are_same({ "rgb", { 0, 0, 0 }, 0 }, csscolor4.rgb("-20%", "-40%", "-60%", "-10%"))
    assert.are_same({ "rgb", { 0, 0, 0 }, 0 }, csscolor4.rgb("-20%", "-40%", "-60%", "-0.5"))
  end)
end)

describe("srgb", function()
  it("parse srgb", function()
    assert.are_same(nil, csscolor4.srgb("", "", ""))

    assert.are_same({ "srgb", { "none", "none", "none" } }, csscolor4.srgb("none", "none", "none"))
    assert.are_same({ "srgb", { "none", "none", "none" }, "none" }, csscolor4.srgb("none", "none", "none", "none"))

    assert.are_same({ "srgb", { "none", "none", "none" } }, csscolor4.srgb("NONE", "NONE", "NONE"))
    assert.are_same({ "srgb", { "none", "none", "none" }, "none" }, csscolor4.srgb("NONE", "NONE", "NONE", "NONE"))

    assert.are_same({ "srgb", { 0, 0, 0 } }, csscolor4.srgb("0", "0", "0"))
    assert.are_same({ "srgb", { 1, 1, 1 } }, csscolor4.srgb("1", "1", "1"))
    assert.are_same({ "srgb", { 0.2, 0.4, 0.6 } }, csscolor4.srgb("0.2", "0.4", "0.6"))
    assert.are_same({ "srgb", { 0.2, 0.4, 0.6 }, 0.5 }, csscolor4.srgb("0.2", "0.4", "0.6", "50%"))
    assert.are_same({ "srgb", { 0.2, 0.4, 0.6 }, 0.5 }, csscolor4.srgb("0.2", "0.4", "0.6", "0.5"))
    assert.are_same({ "srgb", { 1.2, 1.4, 1.6 }, 1.2 }, csscolor4.srgb("1.2", "1.4", "1.6", "120%"))
    assert.are_same({ "srgb", { -0.2, -0.4, -0.6 } }, csscolor4.srgb("-0.2", "-0.4", "-0.6"))
    assert.are_same({ "srgb", { -0.2, -0.4, -0.6 }, -0.1 }, csscolor4.srgb("-0.2", "-0.4", "-0.6", "-10%"))
    assert.are_same({ "srgb", { -0.2, -0.4, -0.6 }, -0.1 }, csscolor4.srgb("-0.2", "-0.4", "-0.6", "-0.1"))

    assert.are_same({ "srgb", { 0, 0, 0 } }, csscolor4.srgb("0%", "0%", "0%"))
    assert.are_same({ "srgb", { 1, 1, 1 } }, csscolor4.srgb("100%", "100%", "100%"))
    assert.are_same({ "srgb", { 0.2, 0.4, 0.6 } }, csscolor4.srgb("20%", "40%", "60%"))
    assert.are_same({ "srgb", { 0.2, 0.4, 0.6 }, 0.5 }, csscolor4.srgb("20%", "40%", "60%", "50%"))
    assert.are_same({ "srgb", { 0.2, 0.4, 0.6 }, 0.5 }, csscolor4.srgb("20%", "40%", "60%", "0.5"))
    assert.are_same({ "srgb", { 1.2, 1.4, 1.6 }, 1.2 }, csscolor4.srgb("120%", "140%", "160%", "120%"))
    assert.are_same({ "srgb", { -0.2, -0.4, -0.6 } }, csscolor4.srgb("-20%", "-40%", "-60%"))
    assert.are_same({ "srgb", { -0.2, -0.4, -0.6 }, -0.1 }, csscolor4.srgb("-20%", "-40%", "-60%", "-10%"))
    assert.are_same({ "srgb", { -0.2, -0.4, -0.6 }, -0.1 }, csscolor4.srgb("-20%", "-40%", "-60%", "-0.1"))
  end)
end)

describe("hsl", function()
  it("parse hsl", function()
    assert.are_same(nil, csscolor4.hsl("", "", ""))

    assert.are_same({ "hsl", { "none", "none", "none" } }, csscolor4.hsl("none", "none", "none"))
    assert.are_same({ "hsl", { "none", "none", "none" }, "none" }, csscolor4.hsl("none", "none", "none", "none"))

    assert.are_same({ "hsl", { "none", "none", "none" } }, csscolor4.hsl("NONE", "NONE", "NONE"))
    assert.are_same({ "hsl", { "none", "none", "none" }, "none" }, csscolor4.hsl("NONE", "NONE", "NONE", "NONE"))

    assert.are_same({ "hsl", { 0, 0, 0 } }, csscolor4.hsl("0", "0", "0"))
    assert.are_same({ "hsl", { 0, 100, 100 } }, csscolor4.hsl("360", "100", "100"))
    assert.are_same({ "hsl", { 72, 40, 60 } }, csscolor4.hsl("72", "40", "60"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("72", "40", "60", "50%"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("72", "40", "60", "0.5"))
    assert.are_same({ "hsl", { 72, 140, 160 }, 1.2 }, csscolor4.hsl("432", "140", "160", "120%"))
    assert.are_same({ "hsl", { 288, 0, -60 } }, csscolor4.hsl("-72", "-40", "-60"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-72", "-40", "-60", "-10%"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-72", "-40", "-60", "-0.1"))

    assert.are_same({ "hsl", { 0, 0, 0 } }, csscolor4.hsl("0deg", "0", "0"))
    assert.are_same({ "hsl", { 0, 100, 100 } }, csscolor4.hsl("360deg", "100", "100"))
    assert.are_same({ "hsl", { 72, 40, 60 } }, csscolor4.hsl("72deg", "40", "60"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("72deg", "40", "60", "50%"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("72deg", "40", "60", "0.5"))
    assert.are_same({ "hsl", { 72, 140, 160 }, 1.2 }, csscolor4.hsl("432deg", "140", "160", "120%"))
    assert.are_same({ "hsl", { 288, 0, -60 } }, csscolor4.hsl("-72deg", "-40", "-60"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-72deg", "-40", "-60", "-10%"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-72deg", "-40", "-60", "-0.1"))

    assert.are_same({ "hsl", { 0, 0, 0 } }, csscolor4.hsl("0grad", "0", "0"))
    assert.are_same({ "hsl", { 0, 100, 100 } }, csscolor4.hsl("400grad", "100", "100"))
    assert.are_same({ "hsl", { 72, 40, 60 } }, csscolor4.hsl("80grad", "40", "60"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("80grad", "40", "60", "50%"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("80grad", "40", "60", "0.5"))
    assert.are_same({ "hsl", { 72, 140, 160 }, 1.2 }, csscolor4.hsl("480grad", "140", "160", "120%"))
    assert.are_same({ "hsl", { 288, 0, -60 } }, csscolor4.hsl("-80grad", "-40", "-60"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-80grad", "-40", "-60", "-10%"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-80grad", "-40", "-60", "-0.1"))

    assert.are_same({ "hsl", { 0, 0, 0 } }, csscolor4.hsl("0rad", "0", "0"))
    assert.is_near(
      ({ 359.999982, 100, 100 })[1],
      csscolor4.hsl("6.283185rad", "100", "100")[2][1] --[[@as number]],
      0.00001
    )

    assert.are_same({ "hsl", { 0, 0, 0 } }, csscolor4.hsl("0turn", "0", "0"))
    assert.are_same({ "hsl", { 0, 100, 100 } }, csscolor4.hsl("1turn", "100", "100"))
    assert.are_same({ "hsl", { 72, 40, 60 } }, csscolor4.hsl("0.2turn", "40", "60"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("0.2turn", "40", "60", "50%"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("0.2turn", "40", "60", "0.5"))
    assert.are_same({ "hsl", { 72, 140, 160 }, 1.2 }, csscolor4.hsl("1.2turn", "140", "160", "120%"))
    assert.are_same({ "hsl", { 288, 0, -60 } }, csscolor4.hsl("-0.2turn", "-40", "-60"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-0.2turn", "-40", "-60", "-10%"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-0.2turn", "-40", "-60", "-0.1"))

    assert.are_same({ "hsl", { 0, 0, 0 } }, csscolor4.hsl("0", "0%", "0%"))
    assert.are_same({ "hsl", { 0, 100, 100 } }, csscolor4.hsl("360", "100%", "100%"))
    assert.are_same({ "hsl", { 72, 40, 60 } }, csscolor4.hsl("72", "40%", "60%"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("72", "40%", "60%", "50%"))
    assert.are_same({ "hsl", { 72, 40, 60 }, 0.5 }, csscolor4.hsl("72", "40%", "60%", "0.5"))
    assert.are_same({ "hsl", { 72, 140, 160 }, 1.2 }, csscolor4.hsl("432", "140%", "160%", "120%"))
    assert.are_same({ "hsl", { 288, 0, -60 } }, csscolor4.hsl("-72", "-40%", "-60%"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-72", "-40%", "-60%", "-10%"))
    assert.are_same({ "hsl", { 288, 0, -60 }, -0.1 }, csscolor4.hsl("-72", "-40%", "-60%", "-0.1"))
  end)
end)

describe("hwb", function()
  it("parse hwb", function()
    assert.are_same(nil, csscolor4.hwb("", "", ""))

    assert.are_same({ "hwb", { "none", "none", "none" } }, csscolor4.hwb("none", "none", "none"))
    assert.are_same({ "hwb", { "none", "none", "none" }, "none" }, csscolor4.hwb("none", "none", "none", "none"))

    assert.are_same({ "hwb", { "none", "none", "none" } }, csscolor4.hwb("NONE", "NONE", "NONE"))
    assert.are_same({ "hwb", { "none", "none", "none" }, "none" }, csscolor4.hwb("NONE", "NONE", "NONE", "NONE"))

    assert.are_same({ "hwb", { 0, 0, 0 } }, csscolor4.hwb("0", "0", "0"))
    assert.are_same({ "hwb", { 0, 100, 100 } }, csscolor4.hwb("360", "100", "100"))
    assert.are_same({ "hwb", { 72, 40, 60 } }, csscolor4.hwb("72", "40", "60"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("72", "40", "60", "50%"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("72", "40", "60", "0.5"))
    assert.are_same({ "hwb", { 72, 140, 160 }, 1.2 }, csscolor4.hwb("432", "140", "160", "120%"))
    assert.are_same({ "hwb", { 288, -40, -60 } }, csscolor4.hwb("-72", "-40", "-60"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-72", "-40", "-60", "-10%"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-72", "-40", "-60", "-0.1"))

    assert.are_same({ "hwb", { 0, 0, 0 } }, csscolor4.hwb("0deg", "0", "0"))
    assert.are_same({ "hwb", { 0, 100, 100 } }, csscolor4.hwb("360deg", "100", "100"))
    assert.are_same({ "hwb", { 72, 40, 60 } }, csscolor4.hwb("72deg", "40", "60"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("72deg", "40", "60", "50%"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("72deg", "40", "60", "0.5"))
    assert.are_same({ "hwb", { 72, 140, 160 }, 1.2 }, csscolor4.hwb("432deg", "140", "160", "120%"))
    assert.are_same({ "hwb", { 288, -40, -60 } }, csscolor4.hwb("-72deg", "-40", "-60"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-72deg", "-40", "-60", "-10%"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-72deg", "-40", "-60", "-0.1"))

    assert.are_same({ "hwb", { 0, 0, 0 } }, csscolor4.hwb("0grad", "0", "0"))
    assert.are_same({ "hwb", { 0, 100, 100 } }, csscolor4.hwb("400grad", "100", "100"))
    assert.are_same({ "hwb", { 72, 40, 60 } }, csscolor4.hwb("80grad", "40", "60"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("80grad", "40", "60", "50%"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("80grad", "40", "60", "0.5"))
    assert.are_same({ "hwb", { 72, 140, 160 }, 1.2 }, csscolor4.hwb("480grad", "140", "160", "120%"))
    assert.are_same({ "hwb", { 288, -40, -60 } }, csscolor4.hwb("-80grad", "-40", "-60"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-80grad", "-40", "-60", "-10%"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-80grad", "-40", "-60", "-0.1"))

    assert.are_same({ "hwb", { 0, 0, 0 } }, csscolor4.hwb("0rad", "0", "0"))
    assert.is_near(
      ({ 359.999982, 100, 100 })[1],
      csscolor4.hwb("6.283185rad", "100", "100")[2][1] --[[@as number]],
      0.00001
    )

    assert.are_same({ "hwb", { 0, 0, 0 } }, csscolor4.hwb("0turn", "0", "0"))
    assert.are_same({ "hwb", { 0, 100, 100 } }, csscolor4.hwb("1turn", "100", "100"))
    assert.are_same({ "hwb", { 72, 40, 60 } }, csscolor4.hwb("0.2turn", "40", "60"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("0.2turn", "40", "60", "50%"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("0.2turn", "40", "60", "0.5"))
    assert.are_same({ "hwb", { 72, 140, 160 }, 1.2 }, csscolor4.hwb("1.2turn", "140", "160", "120%"))
    assert.are_same({ "hwb", { 288, -40, -60 } }, csscolor4.hwb("-0.2turn", "-40", "-60"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-0.2turn", "-40", "-60", "-10%"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-0.2turn", "-40", "-60", "-0.1"))

    assert.are_same({ "hwb", { 0, 0, 0 } }, csscolor4.hwb("0", "0%", "0%"))
    assert.are_same({ "hwb", { 0, 100, 100 } }, csscolor4.hwb("360", "100%", "100%"))
    assert.are_same({ "hwb", { 72, 40, 60 } }, csscolor4.hwb("72", "40%", "60%"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("72", "40%", "60%", "50%"))
    assert.are_same({ "hwb", { 72, 40, 60 }, 0.5 }, csscolor4.hwb("72", "40%", "60%", "0.5"))
    assert.are_same({ "hwb", { 72, 140, 160 }, 1.2 }, csscolor4.hwb("432", "140%", "160%", "120%"))
    assert.are_same({ "hwb", { 288, -40, -60 } }, csscolor4.hwb("-72", "-40%", "-60%"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-72", "-40%", "-60%", "-10%"))
    assert.are_same({ "hwb", { 288, -40, -60 }, -0.1 }, csscolor4.hwb("-72", "-40%", "-60%", "-0.1"))
  end)
end)

describe("lab", function()
  it("parse lab", function()
    assert.are_same(nil, csscolor4.lab("", "", ""))

    assert.are_same({ "lab", { "none", "none", "none" } }, csscolor4.lab("none", "none", "none"))
    assert.are_same({ "lab", { "none", "none", "none" }, "none" }, csscolor4.lab("none", "none", "none", "none"))

    assert.are_same({ "lab", { "none", "none", "none" } }, csscolor4.lab("NONE", "NONE", "NONE"))
    assert.are_same({ "lab", { "none", "none", "none" }, "none" }, csscolor4.lab("NONE", "NONE", "NONE", "NONE"))

    assert.are_same({ "lab", { 0, 0, 0 } }, csscolor4.lab("0", "0", "0"))
    assert.are_same({ "lab", { 100, 125, 125 } }, csscolor4.lab("100", "125", "125"))
    assert.are_same({ "lab", { 100, -125, -125 } }, csscolor4.lab("100", "-125", "-125"))
    assert.are_same({ "lab", { 20, 50, 75 } }, csscolor4.lab("20", "50", "75"))
    assert.are_same({ "lab", { 20, 50, 75 }, 0.5 }, csscolor4.lab("20", "50", "75", "50%"))
    assert.are_same({ "lab", { 20, 50, 75 }, 0.5 }, csscolor4.lab("20", "50", "75", "0.5"))
    assert.are_same({ "lab", { 100, 175, 200 }, 1.2 }, csscolor4.lab("120", "175", "200", "120%"))
    assert.are_same({ "lab", { 0, -50, -75 } }, csscolor4.lab("-20", "-50", "-75"))
    assert.are_same({ "lab", { 0, -50, -75 }, -0.1 }, csscolor4.lab("-20", "-50", "-75", "-10%"))
    assert.are_same({ "lab", { 0, -50, -75 }, -0.1 }, csscolor4.lab("-20", "-50", "-75", "-0.1"))

    assert.are_same({ "lab", { 0, 0, 0 } }, csscolor4.lab("0%", "0%", "0%"))
    assert.are_same({ "lab", { 100, 125, 125 } }, csscolor4.lab("100%", "100%", "100%"))
    assert.are_same({ "lab", { 100, -125, -125 } }, csscolor4.lab("100%", "-100%", "-100%"))
    assert.are_same({ "lab", { 20, 50, 75 } }, csscolor4.lab("20%", "40%", "60%"))
    assert.are_same({ "lab", { 20, 50, 75 }, 0.5 }, csscolor4.lab("20%", "40%", "60%", "50%"))
    assert.are_same({ "lab", { 20, 50, 75 }, 0.5 }, csscolor4.lab("20%", "40%", "60%", "0.5"))
    assert.are_same({ "lab", { 100, 175, 200 }, 1.2 }, csscolor4.lab("120%", "140%", "160%", "120%"))
    assert.are_same({ "lab", { 0, -50, -75 } }, csscolor4.lab("-20%", "-40%", "-60%"))
    assert.are_same({ "lab", { 0, -50, -75 }, -0.1 }, csscolor4.lab("-20%", "-40%", "-60%", "-10%"))
    assert.are_same({ "lab", { 0, -50, -75 }, -0.1 }, csscolor4.lab("-20%", "-40%", "-60%", "-0.1"))
  end)
end)

describe("lch", function()
  it("parse lch", function()
    assert.are_same(nil, csscolor4.lch("", "", ""))

    assert.are_same({ "lch", { "none", "none", "none" } }, csscolor4.lch("none", "none", "none"))
    assert.are_same({ "lch", { "none", "none", "none" }, "none" }, csscolor4.lch("none", "none", "none", "none"))

    assert.are_same({ "lch", { "none", "none", "none" } }, csscolor4.lch("NONE", "NONE", "NONE"))
    assert.are_same({ "lch", { "none", "none", "none" }, "none" }, csscolor4.lch("NONE", "NONE", "NONE", "NONE"))

    assert.are_same({ "lch", { 0, 0, 0 } }, csscolor4.lch("0", "0", "0"))
    assert.are_same({ "lch", { 100, 150, 0 } }, csscolor4.lch("100", "150", "360"))
    assert.are_same({ "lch", { 40, 90, 72 } }, csscolor4.lch("40", "90", "72"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "72", "50%"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "72", "0.5"))
    assert.are_same({ "lch", { 100, 240, 72 }, 1.2 }, csscolor4.lch("140", "240", "432", "120%"))
    assert.are_same({ "lch", { 0, 0, 288 } }, csscolor4.lch("-40", "-90", "-72"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-72", "-10%"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-72", "-0.1"))

    assert.are_same({ "lch", { 0, 0, 0 } }, csscolor4.lch("0", "0", "0deg"))
    assert.are_same({ "lch", { 100, 150, 0 } }, csscolor4.lch("100", "150", "360deg"))
    assert.are_same({ "lch", { 40, 90, 72 } }, csscolor4.lch("40", "90", "72deg"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "72deg", "50%"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "72deg", "0.5"))
    assert.are_same({ "lch", { 100, 240, 72 }, 1.2 }, csscolor4.lch("140", "240", "432deg", "120%"))
    assert.are_same({ "lch", { 0, 0, 288 } }, csscolor4.lch("-40", "-90", "-72deg"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-72deg", "-10%"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-72deg", "-0.1"))

    assert.are_same({ "lch", { 0, 0, 0 } }, csscolor4.lch("0", "0", "0grad"))
    assert.are_same({ "lch", { 100, 150, 0 } }, csscolor4.lch("100", "150", "400grad"))
    assert.are_same({ "lch", { 40, 90, 72 } }, csscolor4.lch("40", "90", "80grad"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "80grad", "50%"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "80grad", "0.5"))
    assert.are_same({ "lch", { 100, 240, 72 }, 1.2 }, csscolor4.lch("140", "240", "480grad", "120%"))
    assert.are_same({ "lch", { 0, 0, 288 } }, csscolor4.lch("-40", "-90", "-80grad"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-80grad", "-10%"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-80grad", "-0.1"))

    assert.are_same({ "lch", { 0, 0, 0 } }, csscolor4.lch("0", "0", "0rad"))
    assert.is_near(
      ({ 100, 150, 359.999982 })[1],
      csscolor4.lch("100", "150", "6.283185rad")[2][1] --[[@as number]],
      0.00001
    )

    assert.are_same({ "lch", { 0, 0, 0 } }, csscolor4.lch("0", "0", "0turn"))
    assert.are_same({ "lch", { 100, 150, 0 } }, csscolor4.lch("100", "150", "1turn"))
    assert.are_same({ "lch", { 40, 90, 72 } }, csscolor4.lch("40", "90", "0.2turn"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "0.2turn", "50%"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40", "90", "0.2turn", "0.5"))
    assert.are_same({ "lch", { 100, 240, 72 }, 1.2 }, csscolor4.lch("140", "240", "0.2turn", "120%"))
    assert.are_same({ "lch", { 0, 0, 288 } }, csscolor4.lch("-40", "-90", "-0.2turn"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-0.2turn", "-10%"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40", "-90", "-0.2turn", "-0.1"))

    assert.are_same({ "lch", { 0, 0, 0 } }, csscolor4.lch("0%", "0%", "0"))
    assert.are_same({ "lch", { 100, 150, 0 } }, csscolor4.lch("100%", "100%", "360"))
    assert.are_same({ "lch", { 40, 90, 72 } }, csscolor4.lch("40%", "60%", "72"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40%", "60%", "72", "50%"))
    assert.are_same({ "lch", { 40, 90, 72 }, 0.5 }, csscolor4.lch("40%", "60%", "72", "0.5"))
    assert.are_same({ "lch", { 100, 240, 72 }, 1.2 }, csscolor4.lch("140%", "160%", "432", "120%"))
    assert.are_same({ "lch", { 0, 0, 288 } }, csscolor4.lch("-40%", "-60%", "-72"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40%", "-60%", "-72", "-10%"))
    assert.are_same({ "lch", { 0, 0, 288 }, -0.1 }, csscolor4.lch("-40%", "-60%", "-72", "-0.1"))
  end)
end)
